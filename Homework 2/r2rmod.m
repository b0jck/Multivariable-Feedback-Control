% Evaluation of the coeefficients A B C D% for a single value of betafunction [A,B,C,D] = r2rmod(b)global L ro J0 Jp Mp za zck1 = J0*b.^3/ro;k2 = Jp*b.^3/ro;s = sin(b*L);c = cos(b*L);sh = sinh(b*L);ch = cosh(b*L);za = (k1.*k2.*(s+sh)-k1.*(c+ch)+2*sh-2*k2.*ch)/(k1.*k2.*(c-ch)+k1.*(s+sh));zc = -(k1.*k2.*(s+sh)-k1.*(c+ch)-2*k2.*c-2*s)/(k1.*k2.*(c-ch)+k1.*(s+sh));t1 = ro*quad('r2rnorm',0,L,1e-6,[],b);t2 = J0*b.^2.*(za+zc).^2;t3 = Jp*b.^2.*(za.*c-s+zc.*ch-sh).^2;t4 = Mp*r2rnorm(L,b);B2 = 1./(t1+t2+t3+t4);B = sqrt(B2);A = za.*B;C = zc.*B;D = -B;